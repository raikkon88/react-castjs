(this["webpackJsonpreact-castjs-example"]=this["webpackJsonpreact-castjs-example"]||[]).push([[0],{10:function(e,t,n){e.exports=n.p+"static/media/chromecast~bhycLeeK.4a5ab6bd.svg"},11:function(e,t,n){e.exports=n(21)},12:function(e,t,n){},20:function(e,t,n){},21:function(e,t,n){"use strict";n.r(t);n(12);var i=n(0),a=n.n(i),r=n(7),s=n.n(r),c=n(2),o=n(1),l=n.n(o),u=n(3),h=n(8),d=n(9),m=n(10),p=n.n(m);var v=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};Object(h.a)(this,e),t.receiver&&""!==t.receiver||(t.receiver="CC1AD845"),this._events={},this._player=null,this._controller=null,this._mediaSession=null,this.version="v4.1.2",this.receiver=t.receiver,this.joinpolicy=t.joinpolicy,this.available=!1,this.connected=!1,this.device="Chromecast",this.src="",this.title="",this.description="",this.poster="",this.subtitles=[],this.volumeLevel=1,this.muted=!1,this.paused=!1,this.time=0,this.timePretty="00:00:00",this.duration=0,this.durationPretty="00:00:00",this.progress=0,this.state="disconnected",this._init()}return Object(d.a)(e,[{key:"_init",value:function(){var e=Object(u.a)(l.a.mark((function e(){var t,n,i,a,r,s,c,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(window.chrome&&window.chrome.cast&&window.chrome.cast.isAvailable){e.next=11;break}return e.prev=1,e.next=4,new Promise((function(e,t){if(window.__onGCastApiAvailable=e,window.chrome&&!window.chrome.cast){var n=document.createElement("script");n.src="https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1",n.onerror=t,document.head.appendChild(n)}}));case 4:e.next=11;break;case 6:throw e.prev=6,e.t0=e.catch(1),this.trigger("error",e.t0),console.error(e.t0),new Error("Error loading Cast API");case 11:t=cast.framework,n=t.CastContext,i=void 0===n?null:n,a=t.RemotePlayer,r=t.RemotePlayerController,s=t.CastState,c=t.CastContextEventType,o=[chrome.cast.AutoJoinPolicy.TAB_AND_ORIGIN_SCOPED,chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED,chrome.cast.AutoJoinPolicy.PAGE_SCOPED],this.joinpolicies&&-1!==o.indexOf(this.joinpolicy)||(this.joinpolicy=chrome.cast.AutoJoinPolicy.TAB_AND_ORIGIN_SCOPED),i.getInstance().setOptions({receiverApplicationId:this.receiver,autoJoinPolicy:this.joinpolicy,language:"en-US",resumeSavedSession:!1}),this._player=new a,this._controller=new r(this._player),this._controller.addEventListener("isConnectedChanged",this._isConnectedChanged.bind(this)),this._controller.addEventListener("isMediaLoadedChanged",this._isMediaLoadedChanged.bind(this)),this._controller.addEventListener("isMutedChanged",this._isMutedChanged.bind(this)),this._controller.addEventListener("isPausedChanged",this._isPausedChanged.bind(this)),this._controller.addEventListener("currentTimeChanged",this._currentTimeChanged.bind(this)),this._controller.addEventListener("durationChanged",this._durationChanged.bind(this)),this._controller.addEventListener("volumeLevelChanged",this._volumeLevelChanged.bind(this)),this._controller.addEventListener("playerStateChanged",this._playerStateChanged.bind(this)),i.getInstance().addEventListener(c.CAST_STATE_CHANGED,this._isAvailableChanged.bind(this)),this.available=i.getInstance().getCastState()!==s.NO_DEVICES_AVAILABLE,this.trigger("available");case 28:case"end":return e.stop()}}),e,this,[[1,6]])})));return function(){return e.apply(this,arguments)}}()},{key:"_isAvailableChanged",value:function(e){var t=cast.framework,n=t.CastContext,i=t.CastState;this.available=n.getInstance().getCastState()!==i.NO_DEVICES_AVAILABLE,this.trigger("available")}},{key:"_isMediaLoadedChanged",value:function(){var e=this;this._player.isMediaLoaded&&setTimeout((function(){if(e._player.mediaInfo){for(var t in e.device=cast.framework.CastContext.getInstance().getCurrentSession().getCastDevice().friendlyName||e.device,e.src=e._player.mediaInfo.contentId,e.title=e._player.title||null,e.description=e._player.mediaInfo.metadata.subtitle||null,e.poster=e._player.imageUrl||null,e.subtitles=[],e.volumeLevel=e.volumeLevel=Number(e._player.volumeLevel.toFixed(1)),e.muted=e._player.isMuted,e.paused=e._player.isPaused,e.time=Math.round(e._player.currentTime,1),e.timePretty=e._controller.getFormattedTime(e.time),e.duration=e._player.duration,e.durationPretty=e._controller.getFormattedTime(e._player.duration),e.progress=e._controller.getSeekPosition(e.time,e._player.duration),e.state=e._player.playerState.toLowerCase(),e._player.mediaInfo.tracks)"TEXT"===e._player.mediaInfo.tracks[t].type&&e.subtitles.push({label:e._player.mediaInfo.tracks[t].name,src:e._player.mediaInfo.tracks[t].trackContentId});var n=cast.framework.CastContext.getInstance().getCurrentSession().getSessionObj().media[0].activeTrackIds;n&&n.length&&e.subtitles[n[0]]&&(e.subtitles[n[0]].active=!0)}}))}},{key:"_isConnectedChanged",value:function(){this.connected=this._player.isConnected,this.connected&&(this.device=cast.framework.CastContext.getInstance().getCurrentSession().getCastDevice().friendlyName||this.device),this.state=this.connected?"connected":"disconnected",this.trigger("statechange"),this.trigger(this.connected?"connect":"disconnect")}},{key:"_currentTimeChanged",value:function(){var e=this.time;this.time=Math.round(this._player.currentTime,1),this.duration=this._player.duration,this.progress=this._controller.getSeekPosition(this.time,this.duration),this.timePretty=this._controller.getFormattedTime(this.time),this.durationPretty=this._controller.getFormattedTime(this.duration),e==this.time||this._player.isPaused||this.trigger("timeupdate")}},{key:"_durationChanged",value:function(){this.duration=this._player.duration}},{key:"_volumeLevelChanged",value:function(){this.volumeLevel=Number(this._player.volumeLevel.toFixed(1)),this._player.isMediaLoaded&&this.trigger("volumechange")}},{key:"_isMutedChanged",value:function(){var e=this.muted;this.muted=this._player.isMuted,e!=this.muted&&this.trigger(this.muted?"mute":"unmute")}},{key:"_isPausedChanged",value:function(){this.paused=this._player.isPaused,this.paused&&this.trigger("pause")}},{key:"_playerStateChanged",value:function(){var e,t,n=this;if(this.connected=this._player.isConnected,this.connected)switch(this.device=cast.framework.CastContext.getInstance().getCurrentSession().getCastDevice().friendlyName||this.device,this.state=this._player.playerState.toLowerCase(),this.state){case"idle":return this.trigger("statechange"),(null!==(e=null===(t=this._mediaSession)||void 0===t?void 0:t.idleReason)&&void 0!==e?e:"")!==chrome.cast.media.IdleReason.INTERRUPTED&&(this.state="ended",this.trigger("end")),this;case"buffering":return this.time=Math.round(this._player.currentTime,1),this.duration=this._player.duration,this.progress=this._controller.getSeekPosition(this.time,this.duration),this.timePretty=this._controller.getFormattedTime(this.time),this.durationPretty=this._controller.getFormattedTime(this.duration),this.trigger("statechange"),this.trigger("buffering"),this;case"playing":return setTimeout((function(){n.trigger("statechange"),n.trigger("playing")})),this}}},{key:"on",value:function(e,t){return this._events[e]||(this._events[e]=[]),this._events[e].push(t),this}},{key:"off",value:function(e,t){var n=this;return e?this._events[e]&&(t?this._events[e].forEach((function(i,a){t.toString()===i.toString()&&n._events[e].splice(a,1)})):this._events[e]=[]):this._events={},this}},{key:"trigger",value:function(e){var t=Array.prototype.slice.call(arguments,1);for(var n in this._events[e])this._events[e][n].apply(this,t);if("error"===e)return this;for(var n in this._events.event)this._events.event[n].apply(this,[e]);return this}},{key:"cast",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(){var e=Object(u.a)(l.a.mark((function e(t){var n,i,a,r,s,c=arguments;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s=function(){return(s=Object(u.a)(l.a.mark((function e(){var t,n,a,r,s;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i.getInstance().getCurrentSession()){e.next=2;break}return e.abrupt("return",this.trigger("error","Could not connect with the cast device"));case 2:if((t=new chrome.cast.media.MediaInfo(this.src)).metadata=new chrome.cast.media.GenericMediaMetadata,this.subtitles.length){for(a in t.textTrackStyle=new chrome.cast.media.TextTrackStyle,t.textTrackStyle.backgroundColor="#00000000",t.textTrackStyle.edgeColor="#00000016",t.textTrackStyle.edgeType="DROP_SHADOW",t.textTrackStyle.fontFamily="CASUAL",t.textTrackStyle.fontScale=1,t.textTrackStyle.foregroundColor="#FFFFFF",n=[],this.subtitles)(r=new chrome.cast.media.Track(a,"TEXT")).name=this.subtitles[a].label,r.subtype="CAPTIONS",r.trackContentId=this.subtitles[a].src,r.trackContentType="text/vtt",r.trackId=parseInt(a),n.push(r);t.tracks=n}if(t.metadata.images=[new chrome.cast.Image(this.poster)],t.metadata.title=this.title,t.metadata.subtitle=this.description,(s=new chrome.cast.media.LoadRequest(t)).currentTime=this.time,s.autoplay=!this.paused,!this.subtitles.length){e.next=20;break}e.t0=l.a.keys(this.subtitles);case 13:if((e.t1=e.t0()).done){e.next=20;break}if(a=e.t1.value,!this.subtitles[a].active){e.next=18;break}return s.activeTrackIds=[parseInt(a)],e.abrupt("break",20);case 18:e.next=13;break;case 20:return e.prev=20,e.next=23,i.getInstance().getCurrentSession().loadMedia(s);case 23:this.device=i.getInstance().getCurrentSession().getCastDevice().friendlyName||this.device,this._mediaSession=i.getInstance().getCurrentSession().getMediaSession(),e.next=30;break;case 27:return e.prev=27,e.t2=e.catch(20),e.abrupt("return",this.trigger("error",e.t2));case 30:case"end":return e.stop()}}),e,this,[[20,27]])})))).apply(this,arguments)},r=function(){return s.apply(this,arguments)},n=c.length>1&&void 0!==c[1]?c[1]:{},t){e.next=5;break}return e.abrupt("return",this.trigger("error","No media source specified."));case 5:for(a in i=cast.framework.CastContext,n.src=t,n)n.hasOwnProperty(a)&&(this[a]=n[a]);if(e.prev=8,i.getInstance().getCurrentSession()){e.next=12;break}return e.next=12,i.getInstance().requestSession();case 12:return e.next=14,r.apply(this);case 14:e.next=19;break;case 16:e.prev=16,e.t0=e.catch(8),"cancel"!==e.t0&&this.trigger("error",e.t0);case 19:case"end":return e.stop()}}),e,this,[[8,16]])})));return function(t){return e.apply(this,arguments)}}())},{key:"seek",value:function(e,t){return t&&(e=this._controller.getSeekTime(e,this._player.duration)),this._player.currentTime=e,this._controller.seek(),this}},{key:"volume",value:function(e){return this._player.volumeLevel=e,this._controller.setVolumeLevel(),this}},{key:"play",value:function(){return this.paused&&this._controller.playOrPause(),this}},{key:"pause",value:function(){return this.paused||this._controller.playOrPause(),this}},{key:"mute",value:function(){return this.muted||this._controller.muteOrUnmute(),this}},{key:"unmute",value:function(){return this.muted&&this._controller.muteOrUnmute(),this}},{key:"subtitle",value:function(e){var t=this,n=new chrome.cast.media.EditTracksInfoRequest([parseInt(e)]);cast.framework.CastContext.getInstance().getCurrentSession().getSessionObj().media[0].editTracksInfo(n,(function(){for(var n in t.subtitles)delete t.subtitles[n].active,n==e&&(t.subtitles[n].active=!0);return t.trigger("subtitlechange")}),(function(e){return t.trigger("error",e)}))}},{key:"disconnect",value:function(){return cast.framework.CastContext.getInstance().endCurrentSession(!0),this._controller.stop(),this._mediaSession=null,this.connected=!1,this.device="Chromecast",this.src="",this.title="",this.description="",this.poster="",this.subtitles=[],this.volumeLevel=1,this.muted=!1,this.paused=!1,this.time=0,this.timePretty="00:00:00",this.duration=0,this.durationPretty="00:00:00",this.progress=0,this.state="disconnected",this.trigger("disconnect"),this}}]),e}(),g=function(){var e=Object(i.useState)(new v),t=Object(c.a)(e,2),n=t[0];t[1];return{chromecast:n}},f=Object(i.createContext)(g),y=function(){return Object(i.useContext)(f)},b="_styles-module__cast_button__8z_HZ";var _=function(e){var t=e.children,n=g();return a.a.createElement(f.Provider,{value:n},t)},C=y,k=function(e){var t=y().chromecast,n=Object(i.useState)(t.available),r=Object(c.a)(n,2),s=r[0],o=r[1],l=e.size,u=void 0===l?20:l,h=e.style,d=void 0===h?{}:h,m=e.title,v=void 0===m?null:m,g=e.onClick,f=void 0===g?function(){console.error("No handler available.")}:g;return Object(i.useEffect)((function(){return t.on("available",(function(){o(t.available)})),function(){t.off()}}),[]),a.a.createElement("button",Object.assign({onClick:f,style:d,className:b,disabled:!s},e),a.a.createElement("img",{src:p.a,style:{width:u,height:u}}),v&&a.a.createElement("span",{style:{marginLeft:"5px",fontSize:"".concat(.55*u,"px")}},v))},S=(n(20),n(6));var E=function(){var e=C().chromecast,t=Object(i.useState)(e.available),n=Object(c.a)(t,2),r=n[0],s=n[1],o=Object(i.useState)(e.connected),h=Object(c.a)(o,2),d=h[0],m=h[1],p=Object(i.useState)(!e.paused),v=Object(c.a)(p,2),g=v[0],f=v[1],y=Object(i.useState)("https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/Sintel.mp4"),b=Object(c.a)(y,2),_=b[0],E=b[1],w=Object(i.useState)("https://upload.wikimedia.org/wikipedia/commons/thumb/8/8f/Sintel_poster.jpg/800px-Sintel_poster.jpg"),x=Object(c.a)(w,2),O=x[0],j=x[1],I=Object(i.useState)("Example Title"),T=Object(c.a)(I,2),P=T[0],L=T[1],A=Object(i.useRef)(),N=Object(i.useRef)(),D=Object(i.useRef)(),F=Object(i.useRef)([]),M=Object(i.useState)([]),R=Object(c.a)(M,2),G=R[0],J=R[1];function U(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.forEach((function(e){F.current.push({date:(new Date).toLocaleTimeString(),msg:e})})),J(Object(S.a)(F.current))}function z(){return(z=Object(u.a)(l.a.mark((function t(){return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.available){t.next=10;break}return t.prev=1,t.next=4,e.cast(_,{poster:O,title:P});case 4:U(["now casting "+_]),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(1),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[1,7]])})))).apply(this,arguments)}return Object(i.useEffect)((function(){function t(){U(["cast available: "+e.available]),s(e.available)}return e.on("available",t),e.on("connect",(function(){U(["cast connected","connected to: "+e.device]),m(e.connected)})),e.on("disconnect",(function(){U(["cast disconnected"]),m(e.connected)})),e.on("error",(function(){U(["error occured"])})),e.on("playing",(function(){f(!0),U(["media playing"])})),e.on("pause",(function(){f(!1),U(["media paused"])})),function(){e.off("connect"),e.off("disconnect"),e.off("available",t),e.off("pause"),e.off("playing")}}),[]),Object(i.useEffect)((function(){D.current&&(D.current.scrollTop=D.current.scrollHeight)}),[G]),a.a.createElement("div",null,a.a.createElement("h1",null,"react-castjs demo"),a.a.createElement("div",{className:"links"},a.a.createElement("a",{href:"https://github.com/smm76/react-castjs",target:"_blank",rel:"noopener"},"view on github"),a.a.createElement("a",{href:"https://www.npmjs.com/package/react-castjs",target:"_blank",rel:"noopener"},"view on npm")),a.a.createElement("code",null,"npm i react-castjs -S"),a.a.createElement("h3",null,"Test casting"),a.a.createElement("div",null,a.a.createElement("label",null,"paste source url (video, audio, image)"),a.a.createElement("input",{ref:function(e){return A.current=e},type:"text",value:_,style:{width:"80%"},onFocus:function(){return A.current.select()},onChange:function(e){return E(e.target.value)}}),a.a.createElement("br",null)),a.a.createElement("div",null,a.a.createElement("label",null,"set poster image"),a.a.createElement("input",{ref:function(e){return N.current=e},type:"text",value:O,style:{width:"80%"},onFocus:function(){return N.current.select()},onChange:function(e){return j(e.target.value)}}),a.a.createElement("br",null)),a.a.createElement("div",null,a.a.createElement("label",null,"set title"),a.a.createElement("input",{type:"text",value:P,style:{width:"80%"},onChange:function(e){return L(e.target.value)}})),a.a.createElement("br",null),a.a.createElement(k,{onClick:function(){return z.apply(this,arguments)},size:30,style:{fontWeight:"bold",background:"#23f17e",padding:".5rem"},title:d?"cast":"start casting",disabled:!r||""===_}),a.a.createElement("div",{style:{position:"relative"}},G.length>0&&a.a.createElement("button",{className:"clear",onClick:function(){F.current=[],J(Object(S.a)(F.current))}},"clear"),a.a.createElement("div",{ref:function(e){return D.current=e},className:"status"},G.map((function(e,t){return a.a.createElement("div",{key:t.toString()},a.a.createElement("small",{style:{fontSize:".7rem"}},"[",e.date,"]")," ",e.msg)})))),d&&a.a.createElement("div",{className:"controls"},g?a.a.createElement("button",{onClick:function(){return e.pause()}},"pause"):a.a.createElement("button",{onClick:function(){return e.play()}},"play"),a.a.createElement("button",{onClick:function(){return e.disconnect()},style:{marginLeft:".5rem"}},"disconnect")))},w=function(){return a.a.createElement(_,null,a.a.createElement("div",{className:"app"},a.a.createElement(E,null)))};s.a.render(a.a.createElement(w,null),document.getElementById("root"))}},[[11,1,2]]]);
//# sourceMappingURL=main.83d27f3f.chunk.js.map