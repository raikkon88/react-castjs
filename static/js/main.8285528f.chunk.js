(this["webpackJsonpreact-castjs-example"]=this["webpackJsonpreact-castjs-example"]||[]).push([[0],{10:function(e,t,n){},17:function(e,t,n){},19:function(e,t,n){"use strict";n.r(t);n(10);var r=n(0),i=n.n(r),a=n(6),s=n.n(a),o=n(7),c=n.n(o);"undefined"!==typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!==typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));function l(e,t){try{var n=e()}catch(r){return t(r)}return n&&n.then?n.then(void 0,t):n}var u=new Promise((function(e,t){setTimeout(e,5e3)})),d=function(){function e(e){void 0===e&&(e={}),e.receiver&&""!==e.receiver||(e.receiver="CC1AD845"),this._events={},this._player=null,this._controller=null,this._mediaSession=null,this.version="v4.1.2",this.receiver=e.receiver,this.joinpolicy=e.joinpolicy,this.available=!1,this.connected=!1,this.device="Chromecast",this.src="",this.title="",this.description="",this.poster="",this.subtitles=[],this.volumeLevel=1,this.muted=!1,this.paused=!1,this.time=0,this.timePretty="00:00:00",this.duration=0,this.durationPretty="00:00:00",this.progress=0,this.state="disconnected",this._init()}var t=e.prototype;return t._init=function(){try{var e=!1,t=this,n=function(n){if(e)return n;var r=cast.framework,i=r.CastContext,a=void 0===i?null:i,s=r.RemotePlayer,o=r.RemotePlayerController,c=r.CastState,l=r.CastContextEventType,u=[chrome.cast.AutoJoinPolicy.TAB_AND_ORIGIN_SCOPED,chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED,chrome.cast.AutoJoinPolicy.PAGE_SCOPED];t.joinpolicies&&-1!==u.indexOf(t.joinpolicy)||(t.joinpolicy=chrome.cast.AutoJoinPolicy.TAB_AND_ORIGIN_SCOPED),a.getInstance().setOptions({receiverApplicationId:t.receiver,autoJoinPolicy:t.joinpolicy,language:"en-US",resumeSavedSession:!1}),t._player=new s,t._controller=new o(t._player),t._controller.addEventListener("isConnectedChanged",t._isConnectedChanged.bind(t)),t._controller.addEventListener("isMediaLoadedChanged",t._isMediaLoadedChanged.bind(t)),t._controller.addEventListener("isMutedChanged",t._isMutedChanged.bind(t)),t._controller.addEventListener("isPausedChanged",t._isPausedChanged.bind(t)),t._controller.addEventListener("currentTimeChanged",t._currentTimeChanged.bind(t)),t._controller.addEventListener("durationChanged",t._durationChanged.bind(t)),t._controller.addEventListener("volumeLevelChanged",t._volumeLevelChanged.bind(t)),t._controller.addEventListener("playerStateChanged",t._playerStateChanged.bind(t)),a.getInstance().addEventListener(l.CAST_STATE_CHANGED,t._isAvailableChanged.bind(t)),t.available=a.getInstance().getCastState()!==c.NO_DEVICES_AVAILABLE,t.trigger("available")},r=function(){if(!window.chrome||!window.chrome.cast||!window.chrome.cast.isAvailable)return l((function(){return Promise.resolve(Promise.race([new Promise((function(e,t){if(window.__onGCastApiAvailable=e,window.chrome&&!window.chrome.cast){var n=document.createElement("script");n.src="https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1",n.onerror=t,document.head.appendChild(n)}})),u])).then((function(){if(!window.chrome||!window.chrome.cast||!window.chrome.cast.isAvailable)return e=!0,t.trigger("error","Not available in this browser")}))}),(function(e){throw t.trigger("error",e),new Error("Error loading Cast API")}))}();return Promise.resolve(r&&r.then?r.then(n):n(r))}catch(i){return Promise.reject(i)}},t._isAvailableChanged=function(e){var t=cast.framework,n=t.CastContext,r=t.CastState;this.available=n.getInstance().getCastState()!==r.NO_DEVICES_AVAILABLE,this.trigger("available")},t._isMediaLoadedChanged=function(){var e=this;this._player.isMediaLoaded&&setTimeout((function(){if(e._player.mediaInfo){for(var t in e.device=cast.framework.CastContext.getInstance().getCurrentSession().getCastDevice().friendlyName||e.device,e.src=e._player.mediaInfo.contentId,e.title=e._player.title||null,e.description=e._player.mediaInfo.metadata.subtitle||null,e.poster=e._player.imageUrl||null,e.subtitles=[],e.volumeLevel=e.volumeLevel=Number(e._player.volumeLevel.toFixed(1)),e.muted=e._player.isMuted,e.paused=e._player.isPaused,e.time=Math.round(e._player.currentTime,1),e.timePretty=e._controller.getFormattedTime(e.time),e.duration=e._player.duration,e.durationPretty=e._controller.getFormattedTime(e._player.duration),e.progress=e._controller.getSeekPosition(e.time,e._player.duration),e.state=e._player.playerState.toLowerCase(),e._player.mediaInfo.tracks)"TEXT"===e._player.mediaInfo.tracks[t].type&&e.subtitles.push({label:e._player.mediaInfo.tracks[t].name,src:e._player.mediaInfo.tracks[t].trackContentId});var n=cast.framework.CastContext.getInstance().getCurrentSession().getSessionObj().media[0].activeTrackIds;n&&n.length&&e.subtitles[n[0]]&&(e.subtitles[n[0]].active=!0)}}))},t._isConnectedChanged=function(){this.connected=this._player.isConnected,this.connected&&(this.device=cast.framework.CastContext.getInstance().getCurrentSession().getCastDevice().friendlyName||this.device),this.state=this.connected?"connected":"disconnected",this.trigger("statechange"),this.trigger(this.connected?"connect":"disconnect")},t._currentTimeChanged=function(){var e=this.time;this.time=Math.round(this._player.currentTime,1),this.duration=this._player.duration,this.progress=this._controller.getSeekPosition(this.time,this.duration),this.timePretty=this._controller.getFormattedTime(this.time),this.durationPretty=this._controller.getFormattedTime(this.duration),e==this.time||this._player.isPaused||this.trigger("timeupdate")},t._durationChanged=function(){this.duration=this._player.duration},t._volumeLevelChanged=function(){this.volumeLevel=Number(this._player.volumeLevel.toFixed(1)),this._player.isMediaLoaded&&this.trigger("volumechange")},t._isMutedChanged=function(){var e=this.muted;this.muted=this._player.isMuted,e!=this.muted&&this.trigger(this.muted?"mute":"unmute")},t._isPausedChanged=function(){this.paused=this._player.isPaused,this.paused&&this.trigger("pause")},t._playerStateChanged=function(){var e,t,n=this;if(this.connected=this._player.isConnected,this.connected)switch(this.device=cast.framework.CastContext.getInstance().getCurrentSession().getCastDevice().friendlyName||this.device,this.state=this._player.playerState.toLowerCase(),this.state){case"idle":return this.trigger("statechange"),(null!=(e=null===(t=this._mediaSession)||void 0===t?void 0:t.idleReason)?e:"")!==chrome.cast.media.IdleReason.INTERRUPTED&&(this.state="ended",this.trigger("end")),this;case"buffering":return this.time=Math.round(this._player.currentTime,1),this.duration=this._player.duration,this.progress=this._controller.getSeekPosition(this.time,this.duration),this.timePretty=this._controller.getFormattedTime(this.time),this.durationPretty=this._controller.getFormattedTime(this.duration),this.trigger("statechange"),this.trigger("buffering"),this;case"playing":return setTimeout((function(){n.trigger("statechange"),n.trigger("playing")})),this}},t.on=function(e,t){return this._events[e]||(this._events[e]=[]),this._events[e].push(t),this},t.off=function(e,t){var n=this;return e?this._events[e]&&(t?this._events[e].forEach((function(r,i){t.toString()===r.toString()&&n._events[e].splice(i,1)})):this._events[e]=[]):this._events={},this},t.trigger=function(e){var t=Array.prototype.slice.call(arguments,1);for(var n in this._events[e])this._events[e][n].apply(this,t);if("error"===e)return this;for(var n in this._events.event)this._events.event[n].apply(this,[e]);return this},t.cast=function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){void 0===t&&(t={});try{var n=this,r=function(){try{var e=this;if(!i.getInstance().getCurrentSession())return Promise.resolve(e.trigger("error","Could not connect with the cast device"));var t=new chrome.cast.media.MediaInfo(e.src);if(t.metadata=new chrome.cast.media.GenericMediaMetadata,e.subtitles.length){t.textTrackStyle=new chrome.cast.media.TextTrackStyle,t.textTrackStyle.backgroundColor="#00000000",t.textTrackStyle.edgeColor="#00000016",t.textTrackStyle.edgeType="DROP_SHADOW",t.textTrackStyle.fontFamily="CASUAL",t.textTrackStyle.fontScale=1,t.textTrackStyle.foregroundColor="#FFFFFF";var n=[];for(var r in e.subtitles){var a=new chrome.cast.media.Track(r,"TEXT");a.name=e.subtitles[r].label,a.subtype="CAPTIONS",a.trackContentId=e.subtitles[r].src,a.trackContentType="text/vtt",a.trackId=parseInt(r),n.push(a)}t.tracks=n}t.metadata.images=[new chrome.cast.Image(e.poster)],t.metadata.title=e.title,t.metadata.subtitle=e.description;var s=new chrome.cast.media.LoadRequest(t);if(s.currentTime=e.time,s.autoplay=!e.paused,e.subtitles.length)for(var r in e.subtitles)if(e.subtitles[r].active)return s.activeTrackIds=[parseInt(r)],Promise.resolve();return Promise.resolve(l((function(){return Promise.resolve(i.getInstance().getCurrentSession().loadMedia(s)).then((function(){e.device=i.getInstance().getCurrentSession().getCastDevice().friendlyName||e.device,e._mediaSession=i.getInstance().getCurrentSession().getMediaSession()}))}),(function(t){return e.trigger("error",t)})))}catch(o){return Promise.reject(o)}};if(!e)return Promise.resolve(n.trigger("error","No media source specified."));var i=cast.framework.CastContext;for(var a in t.src=e,t)t.hasOwnProperty(a)&&(n[a]=t[a]);var s=l((function(){function e(){return Promise.resolve(r.apply(n)).then((function(){}))}var t=function(){if(!i.getInstance().getCurrentSession())return Promise.resolve(i.getInstance().requestSession()).then((function(){}))}();return t&&t.then?t.then(e):e()}),(function(e){"cancel"!==e&&n.trigger("error",e)}));return Promise.resolve(s&&s.then?s.then((function(){})):void 0)}catch(o){return Promise.reject(o)}})),t.seek=function(e,t){return t&&(e=this._controller.getSeekTime(e,this._player.duration)),this._player.currentTime=e,this._controller.seek(),this},t.volume=function(e){return this._player.volumeLevel=e,this._controller.setVolumeLevel(),this},t.play=function(){return this.paused&&this._controller.playOrPause(),this},t.pause=function(){return this.paused||this._controller.playOrPause(),this},t.mute=function(){return this.muted||this._controller.muteOrUnmute(),this},t.unmute=function(){return this.muted&&this._controller.muteOrUnmute(),this},t.subtitle=function(e){var t=this,n=new chrome.cast.media.EditTracksInfoRequest([parseInt(e)]);cast.framework.CastContext.getInstance().getCurrentSession().getSessionObj().media[0].editTracksInfo(n,(function(){for(var n in t.subtitles)delete t.subtitles[n].active,n==e&&(t.subtitles[n].active=!0);return t.trigger("subtitlechange")}),(function(e){return t.trigger("error",e)}))},t.disconnect=function(){return cast.framework.CastContext.getInstance().endCurrentSession(!0),this._controller.stop(),this._mediaSession=null,this.connected=!1,this.device="Chromecast",this.src="",this.title="",this.description="",this.poster="",this.subtitles=[],this.volumeLevel=1,this.muted=!1,this.paused=!1,this.time=0,this.timePretty="00:00:00",this.duration=0,this.durationPretty="00:00:00",this.progress=0,this.state="disconnected",this.trigger("disconnect"),this},e}(),h=function(){return{chromecast:Object(r.useState)(new d)[0]}},m=Object(r.createContext)(h),v=function(){return Object(r.useContext)(m)};function g(){return(g=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var f="_8z_HZ";var p=function(e){var t=e.children,n=h();return i.a.createElement(m.Provider,{value:n},t)},y=v,b=function(e){var t=v().chromecast,n=Object(r.useState)(t.available),a=n[0],s=n[1],o=e.size,l=void 0===o?20:o,u=e.style,d=void 0===u?{}:u,h=e.title,m=void 0===h?null:h,p=e.onClick,y=void 0===p?function(){console.error("No handler available.")}:p;return Object(r.useEffect)((function(){return t.on("available",(function(){s(t.available)})),function(){t.off()}}),[]),i.a.createElement("button",g({onClick:y,style:d,className:f,disabled:!a},e),i.a.createElement("img",{src:c.a,style:{width:l,height:l}}),m&&i.a.createElement("span",{style:{marginLeft:"5px",fontSize:.55*l+"px"}},m))},_=(n(17),n(4)),C=n.n(_),S=n(8),E=n(5),w=n(1);var k=function(){var e=y().chromecast,t=Object(r.useState)(e.available),n=Object(w.a)(t,2),a=n[0],s=n[1],o=Object(r.useState)(e.connected),c=Object(w.a)(o,2),l=c[0],u=c[1],d=Object(r.useState)(!e.paused),h=Object(w.a)(d,2),m=h[0],v=h[1],g=Object(r.useState)("https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/Sintel.mp4"),f=Object(w.a)(g,2),p=f[0],_=f[1],k=Object(r.useState)("https://upload.wikimedia.org/wikipedia/commons/thumb/8/8f/Sintel_poster.jpg/800px-Sintel_poster.jpg"),P=Object(w.a)(k,2),I=P[0],j=P[1],O=Object(r.useState)("Example Title"),T=Object(w.a)(O,2),x=T[0],L=T[1],A=Object(r.useRef)(),N=Object(r.useRef)(),D=Object(r.useRef)(),F=Object(r.useRef)([]),M=Object(r.useState)([]),R=Object(w.a)(M,2),G=R[0],J=R[1];function z(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.forEach((function(e){F.current.push({date:(new Date).toLocaleTimeString(),msg:e})})),J(Object(E.a)(F.current))}function U(){return(U=Object(S.a)(C.a.mark((function t(){return C.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.available){t.next=10;break}return t.prev=1,t.next=4,e.cast(p,{poster:I,title:x});case 4:z(["now casting "+p]),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(1),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[1,7]])})))).apply(this,arguments)}return Object(r.useEffect)((function(){function t(){z(["cast available: "+e.available]),s(e.available)}return z(["initializing cast"]),e.on("available",t),e.on("connect",(function(){z(["cast connected","connected to: "+e.device]),u(e.connected)})),e.on("disconnect",(function(){z(["cast disconnected"]),u(e.connected)})),e.on("playing",(function(){v(!0),z(["media playing"])})),e.on("pause",(function(){v(!1),z(["media paused"])})),e.on("error",(function(e){z(["error: "+e])})),function(){e.off("connect"),e.off("disconnect"),e.off("available",t),e.off("pause"),e.off("playing"),e.off("error")}}),[]),Object(r.useEffect)((function(){D.current&&(D.current.scrollTop=D.current.scrollHeight)}),[G]),i.a.createElement("div",null,i.a.createElement("h1",null,"react-castjs demo"),i.a.createElement("div",{className:"links"},i.a.createElement("a",{href:"https://github.com/smm76/react-castjs",target:"_blank",rel:"noopener"},"view on github"),i.a.createElement("a",{href:"https://www.npmjs.com/package/react-castjs",target:"_blank",rel:"noopener"},"view on npm")),i.a.createElement("div",{className:"content"},i.a.createElement("div",null,i.a.createElement("code",null,"npm i react-castjs -S"),i.a.createElement("h3",null,"Test casting"),i.a.createElement("div",null,i.a.createElement("label",null,"paste source url (video, audio, image)"),i.a.createElement("input",{ref:function(e){return A.current=e},type:"text",value:p,onFocus:function(){return A.current.select()},onChange:function(e){return _(e.target.value)}}),i.a.createElement("br",null)),i.a.createElement("div",null,i.a.createElement("label",null,"set poster image"),i.a.createElement("input",{ref:function(e){return N.current=e},type:"text",value:I,onFocus:function(){return N.current.select()},onChange:function(e){return j(e.target.value)}}),i.a.createElement("br",null)),i.a.createElement("div",null,i.a.createElement("label",null,"set title"),i.a.createElement("input",{type:"text",value:x,onChange:function(e){return L(e.target.value)}})),i.a.createElement("br",null),i.a.createElement(b,{onClick:function(){return U.apply(this,arguments)},size:30,style:{fontWeight:"bold",background:"#23f17e",padding:".5rem"},title:l?"cast":"start casting",disabled:!a||""===p})),i.a.createElement("div",null,i.a.createElement("div",{style:{position:"relative"}},G.length>0&&i.a.createElement("button",{className:"clear",onClick:function(){F.current=[],J(Object(E.a)(F.current))}},"clear"),i.a.createElement("div",{ref:function(e){return D.current=e},className:"status"},G.map((function(e,t){return i.a.createElement("div",{key:t.toString()},i.a.createElement("small",{style:{fontSize:".7rem"}},"[",e.date,"]")," ",e.msg)})))),l&&i.a.createElement("div",{className:"controls"},m?i.a.createElement("button",{onClick:function(){return e.pause()}},"pause"):i.a.createElement("button",{onClick:function(){return e.play()}},"play"),i.a.createElement("button",{onClick:function(){return e.disconnect()},style:{marginLeft:".5rem"}},"disconnect")))))},P=function(){return i.a.createElement(p,null,i.a.createElement("div",{className:"app"},i.a.createElement(k,null)))};s.a.render(i.a.createElement(P,null),document.getElementById("root"))},7:function(e,t,n){e.exports=n.p+"static/media/chromecast~bhycLeeK.4a5ab6bd.svg"},9:function(e,t,n){e.exports=n(19)}},[[9,1,2]]]);
//# sourceMappingURL=main.8285528f.chunk.js.map