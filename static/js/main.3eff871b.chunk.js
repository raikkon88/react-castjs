(this["webpackJsonpreact-castjs-example"]=this["webpackJsonpreact-castjs-example"]||[]).push([[0],{10:function(e,t,n){},17:function(e,t,n){},19:function(e,t,n){"use strict";n.r(t);n(10);var r=n(0),i=n.n(r),a=n(6),s=n.n(a),o=n(7),c=n.n(o);"undefined"!==typeof Symbol&&(Symbol.iterator||(Symbol.iterator=Symbol("Symbol.iterator"))),"undefined"!==typeof Symbol&&(Symbol.asyncIterator||(Symbol.asyncIterator=Symbol("Symbol.asyncIterator")));function l(e,t){try{var n=e()}catch(r){return t(r)}return n&&n.then?n.then(void 0,t):n}var u=function(){function e(e){void 0===e&&(e={}),e.receiver&&""!==e.receiver||(e.receiver="CC1AD845"),this._events={},this._player=null,this._controller=null,this._mediaSession=null,this.version="v4.1.2",this.receiver=e.receiver,this.joinpolicy=e.joinpolicy,this.available=!1,this.connected=!1,this.device="Chromecast",this.src="",this.title="",this.description="",this.poster="",this.subtitles=[],this.volumeLevel=1,this.muted=!1,this.paused=!1,this.time=0,this.timePretty="00:00:00",this.duration=0,this.durationPretty="00:00:00",this.progress=0,this.state="disconnected",this._init()}var t=e.prototype;return t._init=function(){try{var e=this,t=function(t){var n=cast.framework,r=n.CastContext,i=void 0===r?null:r,a=n.RemotePlayer,s=n.RemotePlayerController,o=n.CastState,c=n.CastContextEventType,l=[chrome.cast.AutoJoinPolicy.TAB_AND_ORIGIN_SCOPED,chrome.cast.AutoJoinPolicy.ORIGIN_SCOPED,chrome.cast.AutoJoinPolicy.PAGE_SCOPED];e.joinpolicies&&-1!==l.indexOf(e.joinpolicy)||(e.joinpolicy=chrome.cast.AutoJoinPolicy.TAB_AND_ORIGIN_SCOPED),i.getInstance().setOptions({receiverApplicationId:e.receiver,autoJoinPolicy:e.joinpolicy,language:"en-US",resumeSavedSession:!1}),e._player=new a,e._controller=new s(e._player),e._controller.addEventListener("isConnectedChanged",e._isConnectedChanged.bind(e)),e._controller.addEventListener("isMediaLoadedChanged",e._isMediaLoadedChanged.bind(e)),e._controller.addEventListener("isMutedChanged",e._isMutedChanged.bind(e)),e._controller.addEventListener("isPausedChanged",e._isPausedChanged.bind(e)),e._controller.addEventListener("currentTimeChanged",e._currentTimeChanged.bind(e)),e._controller.addEventListener("durationChanged",e._durationChanged.bind(e)),e._controller.addEventListener("volumeLevelChanged",e._volumeLevelChanged.bind(e)),e._controller.addEventListener("playerStateChanged",e._playerStateChanged.bind(e)),i.getInstance().addEventListener(c.CAST_STATE_CHANGED,e._isAvailableChanged.bind(e)),e.available=i.getInstance().getCastState()!==o.NO_DEVICES_AVAILABLE,e.trigger("available")},n=function(){if(!window.chrome||!window.chrome.cast||!window.chrome.cast.isAvailable)return l((function(){return Promise.resolve(new Promise((function(e,t){if(window.__onGCastApiAvailable=e,window.chrome&&!window.chrome.cast){var n=document.createElement("script");n.src="https://www.gstatic.com/cv/js/sender/v1/cast_sender.js?loadCastFramework=1",n.onerror=t,document.head.appendChild(n)}}))).then((function(){}))}),(function(t){throw e.trigger("error",t),console.error(t),new Error("Error loading Cast API")}))}();return Promise.resolve(n&&n.then?n.then(t):t())}catch(r){return Promise.reject(r)}},t._isAvailableChanged=function(e){var t=cast.framework,n=t.CastContext,r=t.CastState;this.available=n.getInstance().getCastState()!==r.NO_DEVICES_AVAILABLE,this.trigger("available")},t._isMediaLoadedChanged=function(){var e=this;this._player.isMediaLoaded&&setTimeout((function(){if(e._player.mediaInfo){for(var t in e.device=cast.framework.CastContext.getInstance().getCurrentSession().getCastDevice().friendlyName||e.device,e.src=e._player.mediaInfo.contentId,e.title=e._player.title||null,e.description=e._player.mediaInfo.metadata.subtitle||null,e.poster=e._player.imageUrl||null,e.subtitles=[],e.volumeLevel=e.volumeLevel=Number(e._player.volumeLevel.toFixed(1)),e.muted=e._player.isMuted,e.paused=e._player.isPaused,e.time=Math.round(e._player.currentTime,1),e.timePretty=e._controller.getFormattedTime(e.time),e.duration=e._player.duration,e.durationPretty=e._controller.getFormattedTime(e._player.duration),e.progress=e._controller.getSeekPosition(e.time,e._player.duration),e.state=e._player.playerState.toLowerCase(),e._player.mediaInfo.tracks)"TEXT"===e._player.mediaInfo.tracks[t].type&&e.subtitles.push({label:e._player.mediaInfo.tracks[t].name,src:e._player.mediaInfo.tracks[t].trackContentId});var n=cast.framework.CastContext.getInstance().getCurrentSession().getSessionObj().media[0].activeTrackIds;n&&n.length&&e.subtitles[n[0]]&&(e.subtitles[n[0]].active=!0)}}))},t._isConnectedChanged=function(){this.connected=this._player.isConnected,this.connected&&(this.device=cast.framework.CastContext.getInstance().getCurrentSession().getCastDevice().friendlyName||this.device),this.state=this.connected?"connected":"disconnected",this.trigger("statechange"),this.trigger(this.connected?"connect":"disconnect")},t._currentTimeChanged=function(){var e=this.time;this.time=Math.round(this._player.currentTime,1),this.duration=this._player.duration,this.progress=this._controller.getSeekPosition(this.time,this.duration),this.timePretty=this._controller.getFormattedTime(this.time),this.durationPretty=this._controller.getFormattedTime(this.duration),e==this.time||this._player.isPaused||this.trigger("timeupdate")},t._durationChanged=function(){this.duration=this._player.duration},t._volumeLevelChanged=function(){this.volumeLevel=Number(this._player.volumeLevel.toFixed(1)),this._player.isMediaLoaded&&this.trigger("volumechange")},t._isMutedChanged=function(){var e=this.muted;this.muted=this._player.isMuted,e!=this.muted&&this.trigger(this.muted?"mute":"unmute")},t._isPausedChanged=function(){this.paused=this._player.isPaused,this.paused&&this.trigger("pause")},t._playerStateChanged=function(){var e,t,n=this;if(this.connected=this._player.isConnected,this.connected)switch(this.device=cast.framework.CastContext.getInstance().getCurrentSession().getCastDevice().friendlyName||this.device,this.state=this._player.playerState.toLowerCase(),this.state){case"idle":return this.trigger("statechange"),(null!=(e=null===(t=this._mediaSession)||void 0===t?void 0:t.idleReason)?e:"")!==chrome.cast.media.IdleReason.INTERRUPTED&&(this.state="ended",this.trigger("end")),this;case"buffering":return this.time=Math.round(this._player.currentTime,1),this.duration=this._player.duration,this.progress=this._controller.getSeekPosition(this.time,this.duration),this.timePretty=this._controller.getFormattedTime(this.time),this.durationPretty=this._controller.getFormattedTime(this.duration),this.trigger("statechange"),this.trigger("buffering"),this;case"playing":return setTimeout((function(){n.trigger("statechange"),n.trigger("playing")})),this}},t.on=function(e,t){return this._events[e]||(this._events[e]=[]),this._events[e].push(t),this},t.off=function(e,t){var n=this;return e?this._events[e]&&(t?this._events[e].forEach((function(r,i){t===r&&n._events[e].splice(i,1)})):this._events[e]=[]):this._events={},this},t.trigger=function(e){var t=Array.prototype.slice.call(arguments,1);for(var n in this._events[e])this._events[e][n].apply(this,t);if("error"===e)return this;for(var n in this._events.event)this._events.event[n].apply(this,[e]);return this},t.cast=function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){void 0===t&&(t={});try{var n=this,r=function(){try{var e=this;if(!i.getInstance().getCurrentSession())return Promise.resolve(e.trigger("error","Could not connect with the cast device"));var t=new chrome.cast.media.MediaInfo(e.src);if(t.metadata=new chrome.cast.media.GenericMediaMetadata,e.subtitles.length){t.textTrackStyle=new chrome.cast.media.TextTrackStyle,t.textTrackStyle.backgroundColor="#00000000",t.textTrackStyle.edgeColor="#00000016",t.textTrackStyle.edgeType="DROP_SHADOW",t.textTrackStyle.fontFamily="CASUAL",t.textTrackStyle.fontScale=1,t.textTrackStyle.foregroundColor="#FFFFFF";var n=[];for(var r in e.subtitles){var a=new chrome.cast.media.Track(r,"TEXT");a.name=e.subtitles[r].label,a.subtype="CAPTIONS",a.trackContentId=e.subtitles[r].src,a.trackContentType="text/vtt",a.trackId=parseInt(r),n.push(a)}t.tracks=n}t.metadata.images=[new chrome.cast.Image(e.poster)],t.metadata.title=e.title,t.metadata.subtitle=e.description;var s=new chrome.cast.media.LoadRequest(t);if(s.currentTime=e.time,s.autoplay=!e.paused,e.subtitles.length)for(var r in e.subtitles)if(e.subtitles[r].active)return s.activeTrackIds=[parseInt(r)],Promise.resolve();return Promise.resolve(l((function(){return Promise.resolve(i.getInstance().getCurrentSession().loadMedia(s)).then((function(){e.device=i.getInstance().getCurrentSession().getCastDevice().friendlyName||e.device,e._mediaSession=i.getInstance().getCurrentSession().getMediaSession()}))}),(function(t){return e.trigger("error",t)})))}catch(o){return Promise.reject(o)}};if(!e)return Promise.resolve(n.trigger("error","No media source specified."));var i=cast.framework.CastContext;for(var a in t.src=e,t)t.hasOwnProperty(a)&&(n[a]=t[a]);var s=l((function(){function e(){return Promise.resolve(r.apply(n)).then((function(){}))}var t=function(){if(!i.getInstance().getCurrentSession())return Promise.resolve(i.getInstance().requestSession()).then((function(){}))}();return t&&t.then?t.then(e):e()}),(function(e){"cancel"!==e&&n.trigger("error",e)}));return Promise.resolve(s&&s.then?s.then((function(){})):void 0)}catch(o){return Promise.reject(o)}})),t.seek=function(e,t){return t&&(e=this._controller.getSeekTime(e,this._player.duration)),this._player.currentTime=e,this._controller.seek(),this},t.volume=function(e){return this._player.volumeLevel=e,this._controller.setVolumeLevel(),this},t.play=function(){return this.paused&&this._controller.playOrPause(),this},t.pause=function(){return this.paused||this._controller.playOrPause(),this},t.mute=function(){return this.muted||this._controller.muteOrUnmute(),this},t.unmute=function(){return this.muted&&this._controller.muteOrUnmute(),this},t.subtitle=function(e){var t=this,n=new chrome.cast.media.EditTracksInfoRequest([parseInt(e)]);cast.framework.CastContext.getInstance().getCurrentSession().getSessionObj().media[0].editTracksInfo(n,(function(){for(var n in t.subtitles)delete t.subtitles[n].active,n==e&&(t.subtitles[n].active=!0);return t.trigger("subtitlechange")}),(function(e){return t.trigger("error",e)}))},t.disconnect=function(){return cast.framework.CastContext.getInstance().endCurrentSession(!0),this._controller.stop(),this._mediaSession=null,this.connected=!1,this.device="Chromecast",this.src="",this.title="",this.description="",this.poster="",this.subtitles=[],this.volumeLevel=1,this.muted=!1,this.paused=!1,this.time=0,this.timePretty="00:00:00",this.duration=0,this.durationPretty="00:00:00",this.progress=0,this.state="disconnected",this.trigger("disconnect"),this},e}(),d=function(){return{chromecast:Object(r.useState)(new u)[0]}},h=Object(r.createContext)(d),m=function(){return Object(r.useContext)(h)};function v(){return(v=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}var g="_8z_HZ";var p=function(e){var t=e.children,n=d();return i.a.createElement(h.Provider,{value:n},t)},f=m,y=function(e){var t=m().chromecast,n=Object(r.useState)(t.available),a=n[0],s=n[1],o=e.size,l=void 0===o?20:o,u=e.style,d=void 0===u?{}:u,h=e.title,p=void 0===h?null:h,f=e.onClick,y=void 0===f?function(){console.error("No handler available.")}:f;return Object(r.useEffect)((function(){return t.on("available",(function(){s(t.available)})),function(){t.off()}}),[]),i.a.createElement("button",v({onClick:y,style:d,className:g,disabled:!a},e),i.a.createElement("img",{src:c.a,style:{width:l,height:l}}),p&&i.a.createElement("span",{style:{marginLeft:"5px",fontSize:.55*l+"px"}},p))},_=(n(17),n(4)),b=n.n(_),C=n(8),S=n(5),E=n(1);var w=function(){var e=f().chromecast,t=Object(r.useState)(e.available),n=Object(E.a)(t,2),a=n[0],s=n[1],o=Object(r.useState)(e.connected),c=Object(E.a)(o,2),l=c[0],u=c[1],d=Object(r.useState)("https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/Sintel.mp4"),h=Object(E.a)(d,2),m=h[0],v=h[1],g=Object(r.useState)("https://upload.wikimedia.org/wikipedia/commons/thumb/8/8f/Sintel_poster.jpg/800px-Sintel_poster.jpg"),p=Object(E.a)(g,2),_=p[0],w=p[1],k=Object(r.useState)("Example Title"),I=Object(E.a)(k,2),P=I[0],T=I[1],j=Object(r.useRef)(),O=Object(r.useRef)(),x=Object(r.useRef)([]),L=Object(r.useState)([]),A=Object(E.a)(L,2),N=A[0],D=A[1];function F(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];e.forEach((function(e){x.current.push({date:(new Date).toLocaleTimeString(),msg:e})})),D(Object(S.a)(x.current))}function M(){return(M=Object(C.a)(b.a.mark((function t(){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e.available){t.next=10;break}return t.prev=1,t.next=4,e.cast(m,{poster:_,title:P});case 4:F(["now casting "+m]),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(1),console.log(t.t0);case 10:case"end":return t.stop()}}),t,null,[[1,7]])})))).apply(this,arguments)}return Object(r.useEffect)((function(){function t(){F(["cast available: "+e.available]),s(e.available)}return e.on("available",t),e.on("connect",(function(){F(["cast connected","connected to: "+e.device]),u(e.connected)})),e.on("disconnect",(function(){F(["cast disconnected"]),u(e.connected)})),e.on("error",(function(){F(["error occured"])})),function(){e.off("connect"),e.off("disconnect"),e.off("available",t)}}),[]),i.a.createElement("div",null,i.a.createElement("h1",null,"react-castjs demo"),i.a.createElement("div",{className:"links"},i.a.createElement("a",{href:"https://github.com/smm76/react-castjs",target:"_blank",rel:"noopener"},"view on github"),i.a.createElement("a",{href:"https://www.npmjs.com/package/react-castjs",target:"_blank",rel:"noopener"},"view on npm")),i.a.createElement("code",null,"npm i react-castjs -S"),i.a.createElement("h3",null,"Test casting"),i.a.createElement("div",null,i.a.createElement("label",null,"paste source url (video, audio, image)"),i.a.createElement("input",{ref:function(e){return j.current=e},type:"text",value:m,style:{width:"80%"},onFocus:function(){return j.current.select()},onChange:function(e){return v(e.target.value)}}),i.a.createElement("br",null)),i.a.createElement("div",null,i.a.createElement("label",null,"set poster image"),i.a.createElement("input",{ref:function(e){return O.current=e},type:"text",value:_,style:{width:"80%"},onFocus:function(){return O.current.select()},onChange:function(e){return w(e.target.value)}}),i.a.createElement("br",null)),i.a.createElement("div",null,i.a.createElement("label",null,"set title"),i.a.createElement("input",{type:"text",value:P,style:{width:"80%"},onChange:function(e){return T(e.target.value)}})),i.a.createElement("br",null),i.a.createElement(y,{onClick:function(){return M.apply(this,arguments)},size:30,style:{fontWeight:"bold",background:"#23f17e",padding:".5rem"},title:l?"cast":"start casting",disabled:!a||""===m}),i.a.createElement("div",{className:"status"},N.length>0&&i.a.createElement("button",{className:"clear",onClick:function(){x.current=[],D(Object(S.a)(x.current))}},"clear"),N.map((function(e,t){return i.a.createElement("div",{key:t.toString()},i.a.createElement("small",{style:{fontSize:".7rem"}},"[",e.date,"]")," ",e.msg)}))),l&&i.a.createElement("button",{onClick:function(){return e.disconnect()}},"disconnect"))},k=function(){return i.a.createElement(p,null,i.a.createElement("div",{className:"app"},i.a.createElement(w,null)))};s.a.render(i.a.createElement(k,null),document.getElementById("root"))},7:function(e,t,n){e.exports=n.p+"static/media/chromecast~bhycLeeK.4a5ab6bd.svg"},9:function(e,t,n){e.exports=n(19)}},[[9,1,2]]]);
//# sourceMappingURL=main.3eff871b.chunk.js.map